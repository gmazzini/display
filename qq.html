<html>
<body>
<canvas id="myCanvas" width="578" height="578" style="background-color:#000000;">
<script>
function componentToHex(c) {
  var hex = c.toString(16);
  return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
  return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
}

function myload(){
  var xmlHttp = new XMLHttpRequest();
  xmlHttp.overrideMimeType('text/plain; charset=x-user-defined');
  xmlHttp.open("GET","http://www.mazzini.org/matrix.php?ip="+ip,false);
  xmlHttp.send(null);
  var x = xmlHttp.response;
  var c = document.getElementById("myCanvas");
  var ctx = c.getContext("2d");

  var z=1;
  for(var j=0;j<64;j++){
    for(var i=0;i<64;i++){
      if(i%2==0){
        var r=x.charCodeAt(z) & 240;
        var g=x.charCodeAt(z+2048) & 240;
        var b=x.charCodeAt(z+4096) & 240;
      }
      else {
        var r=(x.charCodeAt(z) & 15) << 4;
        var g=(x.charCodeAt(z+2048) & 15) << 4;
        var b=(x.charCodeAt(z+4096) & 15) << 4;
        z++;
      }
      ctx.fillStyle = rgbToHex(r,g,b);
      ctx.beginPath();
      ctx.arc(5+i*9,5+j*9,4,0,Math.PI*2,true);
      ctx.closePath();
      ctx.fill();
    }
  }
  setTimeout(myload,1000*x.charCodeAt(0));
}

const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const ip = urlParams.get('ip');
myload();

</script>

</body>
</html>
